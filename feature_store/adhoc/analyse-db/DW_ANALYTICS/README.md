
ADHOC: ANALYSIS

Create customer samples
```
CREATE TABLE CINS_TMP_ALY_CUST_SAMPLE1 AS (
    SELECT CUSTOMER_CDE FROM (
        SELECT DISTINCT CUSTOMER_CDE 
        FROM DW_ANALYTICS.DW_CUSTOMER_FULL_DIM
        ORDER BY DBMS_RANDOM.VALUE)
    WHERE ROWNUM <= 1000000
);

CREATE TABLE CINS_TMP_ALY_CUST_SAMPLE2 AS (
    SELECT CUSTOMER_CDE FROM (
        SELECT DISTINCT CUSTOMER_CDE 
        FROM DW_ANALYTICS.DW_CUSTOMER_FULL_DIM
        ORDER BY DBMS_RANDOM.VALUE)
    WHERE ROWNUM <= 3000000
);


CREATE TABLE CINS_TMP_ALY_CUST_SAMPLE3 AS (
    SELECT CUSTOMER_CDE FROM (
        SELECT DISTINCT CUSTOMER_CDE 
        FROM DW_ANALYTICS.DW_CUSTOMER_FULL_DIM
        ORDER BY DBMS_RANDOM.VALUE)
    WHERE ROWNUM <= 5000000
);
```

Each Sample, I created 3 sub samples

Create customer subsamples of sample 1
```
CREATE TABLE CINS_TMP_ALY_CUST_SAMPLE1_SUB1 AS (
    SELECT CUSTOMER_CDE FROM (
        SELECT DISTINCT CUSTOMER_CDE 
        FROM CINS_TMP_ALY_CUST_SAMPLE1
        ORDER BY DBMS_RANDOM.VALUE)
    WHERE ROWNUM <= 10000
);

CREATE TABLE CINS_TMP_ALY_CUST_SAMPLE1_SUB2 AS (
    SELECT CUSTOMER_CDE FROM (
        SELECT DISTINCT CUSTOMER_CDE 
        FROM CINS_TMP_ALY_CUST_SAMPLE1
        ORDER BY DBMS_RANDOM.VALUE)
    WHERE ROWNUM <= 100000
);


CREATE TABLE CINS_TMP_ALY_CUST_SAMPLE1_SUB3 AS (
    SELECT CUSTOMER_CDE FROM (
        SELECT DISTINCT CUSTOMER_CDE 
        FROM CINS_TMP_ALY_CUST_SAMPLE1
        ORDER BY DBMS_RANDOM.VALUE)
    WHERE ROWNUM <= 500000
);
```

All data is pickle files